webpackJsonp([21],{"L+R6":function(t,e){},zCYa:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("kO88"),l=a("hky6"),n=a("yNs4"),s={name:"setImage",components:{pushImage:i.a},created:function(){var t=this;this.fetchData(),Object(l.h)().then(function(e){t.options=e.data.data,t.options.unshift({catid:"",name:"全部分组"}),t.dialogTable=t.options.slice(1)})},data:function(){return{size:10,currentPage:1,lists:[],page:{},options:[],value:"",input:"",dialogTableVisible:!1,dialog:{aid:"",name:"",catid:""},dialogTable:[]}},methods:{fetchData:function(t){var e=this;"reset"==t&&(this.currentPage=1),""==this.value?Object(l.i)(this.size,this.currentPage).then(function(t){if(e.lists=[],e.page={},0==t.data.code){e.lists=t.data.data,e.page=t.data.page_info;for(var a=0;a<e.lists.length;a++)e.lists[a].date=Object(n.a)(e.lists[a].uploadtime),e.lists[a].img="http://upload.ixn123.com/"+e.lists[a].filepath+"&oss-process=h_100,w_100",e.lists[a].isUpdateName=!1}}):Object(l.j)(this.value,this.size,this.currentPage,this.input).then(function(t){if(e.lists=[],e.page={},0==t.data.code){e.lists=t.data.data,e.page=t.data.page_info;for(var a=0;a<e.lists.length;a++)e.lists[a].date=Object(n.a)(e.lists[a].uploadtime),e.lists[a].img="http://upload.ixn123.com/"+e.lists[a].filepath+"&oss-process=h_100,w_100",e.lists[a].isUpdateName=!1}})},handleSizeChange:function(t){this.size=t,this.fetchData()},handleCurrentChange:function(t){this.currentPage=t,this.fetchData()},deleteThis:function(t){var e=this;this.$confirm("此操作将永久删除该图片, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.e)(t).then(function(t){e.fetchData(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},updateThis:function(t){this.dialogTableVisible=!0,this.dialog.aid=t.aid,this.dialog.name=t.filename,this.dialog.catid=t.catid},handleUpdate:function(t,e){var a=this;e&&(this.dialog.name=e),this.dialog.catid=t.catid,Object(l.m)(this.dialog).then(function(t){0==t.data.code?a.$message.success(t.data.message):a.$message.error(t.data.message),a.dialogTableVisible=!1,a.fetchData()})},updateName:function(t,e){t.isUpdateName=!0,t.filename=t.filename+" ",t.filename=t.filename.slice(0,-1),this.dialog.aid=t.aid,this.dialog.name=t.filename,this.dialog.catid=t.catid}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container newcon"},[a("div",{staticClass:"ui-box clearfix"},[a("div",{staticClass:"pull-left"},[a("push-image",{on:{onSuccess:t.fetchData}})],1),t._v(" "),a("div",{staticClass:"pull-right"},[a("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择"},on:{change:function(e){t.fetchData("reset")}},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.options,function(t,e){return a("el-option",{key:t.catid,attrs:{label:t.name,value:t.catid}})})),t._v(" "),a("el-input",{staticStyle:{width:"120px"},attrs:{placeholder:"请输入内容"},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){t.fetchData("reset")}}},[t._v("搜索")])],1)]),t._v(" "),a("div",{staticClass:"ui-box"},[a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:t.lists,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"预览",width:"120"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.row.img}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"文件名"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.isUpdateName?a("el-input",{attrs:{placeholder:"请输入内容"},on:{blur:function(a){t.handleUpdate(e.row,e.row.filename)}},model:{value:e.row.filename,callback:function(a){t.$set(e.row,"filename",a)},expression:"scope.row.filename"}}):a("div",{on:{click:function(a){t.updateName(e.row,a)}}},[a("span",[t._v(t._s(e.row.filename))]),t._v(" "),a("i",{staticClass:"el-icon-edit el-input__icon"})])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"date",label:"发布时间"}}),t._v(" "),a("el-table-column",{attrs:{label:"管理"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){t.deleteThis(e.row.aid)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"text",icon:"el-icon-setting"},on:{click:function(a){t.updateThis(e.row)}}},[t._v("设置分组")])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"ui-box clearfix"},[a("div",{staticClass:"pull-right"},[void 0!=t.page.total_num?a("el-pagination",{attrs:{background:"","current-page":t.page.current_page,"page-size":10,layout:"prev, pager, next",total:t.page.total_num},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1)]),t._v(" "),a("el-dialog",{attrs:{title:"设置分组",visible:t.dialogTableVisible,width:"30%"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-table",{attrs:{data:t.dialogTable}},[a("el-table-column",{attrs:{property:"name",label:"分组",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.dialog.catid!=e.row.catid?a("el-button",{attrs:{type:"text",icon:"el-icon-setting"},on:{click:function(a){t.handleUpdate(e.row)}}},[t._v("选择该分组")]):t._e()]}}])})],1)],1)],1)},staticRenderFns:[]};var c=a("C7Lr")(s,o,!1,function(t){a("L+R6")},null,null);e.default=c.exports}});
//# sourceMappingURL=21.3387b2b3accf7aa56b3c.js.map