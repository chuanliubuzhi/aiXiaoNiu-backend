webpackJsonp([37],{"cs+o":function(o,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=e("kO88"),a=e("mC1u"),i={name:"editFood",components:{pushImage:s.a},computed:{showSku:function(){return!(this.foods.sku.length<1)},showPro:function(){return!(this.foods.pro.length<1)}},data:function(){return{showGroup:!1,foods:{},foodGroup:[],addGroupInfo:{name:"",order_num:50}}},created:function(){this.getParams(),this.fetchData()},methods:{getParams:function(){this.foods=this.$route.params.pFood},removeImage:function(o){this.foods.food.image.splice(o,1)},showImage:function(o){for(var t=o.splice(0,5),e=0;e<t.length;e++)this.foods.food.image.push(t[e].img)},fetchData:function(){var o=this;Object(a.h)().then(function(t){o.foodGroup=t.data.data})},addGroup:function(){var o=this;Object(a.a)(o.addGroupInfo).then(function(t){0==t.data.code?(o.showGroup=!1,o.fetchData(),o.$message({message:"创建成功！",type:"success"})):o.$message("创建失败")})},delSku:function(o,t){var e=this;if(o.id){var s={id:o.id};Object(a.k)(s).then(function(o){0==o.data.code&&e.foods.sku.splice(t,1)})}else this.foods.sku.splice(t,1)},delPro:function(o,t){var e=this;if(o.property_id){var s={property_id:o.property_id};Object(a.i)(s).then(function(o){0==o.data.code&&e.foods.pro.splice(t,1)})}else this.foods.pro.splice(t,1)},addSku:function(){this.foods.sku.length>3?this.$message({message:"最多只能添加四种商品规格",type:"warning",center:!0}):this.foods.sku.push({name:"",price:null,infinite_count:1,store_count:null})},addPro:function(){this.foods.pro.push({property:{name:""},property_child:[{name:""},{name:""},{name:""},{name:""}]})},subFood:function(){var o=this,t={food:{cat_id:this.foods.food.cat_id,name:this.foods.food.name,price:this.foods.food.price,store_count:this.foods.food.store_count,infinite_count:this.foods.food.infinite_count,content:this.foods.food.content,the_image:this.foods.food.image,today_sale:this.foods.food.today_sale,is_on_sale:this.foods.food.is_on_sale,food_id:this.foods.food.food_id,order_num:this.foods.food.order_num},sku:this.foods.sku,pro:this.foods.pro};Object(a.g)(t).then(function(t){0==t.data.code?(o.$message({type:"success",message:"编辑成功!"}),o.$router.push("/food")):o.$message({type:"info",message:"发布失败!"})})}}},n={render:function(){var o=this,t=o.$createElement,e=o._self._c||t;return e("div",{staticClass:"container",staticStyle:{background:"#fff"}},[e("el-form",{ref:"form",staticStyle:{"min-width":"800px"},attrs:{"label-width":"80px"}},[e("el-form-item",{attrs:{label:"图片"}},[o._l(o.foods.food.image,function(t,s){return e("div",{key:s,staticClass:"picture-list"},[e("div",{staticClass:"picture-list_pic",style:{background:"url("+t+")"}},[e("i",{staticClass:"el-icon-circle-close remove-list",on:{click:function(t){o.removeImage(s)}}})])])}),o._v(" "),e("push-image",{on:{selected:o.showImage}}),o._v(" "),e("p",{staticClass:"ui-color"},[o._v("图片大小不超过3M，最多5张，建议使用方形图片")])],2),o._v(" "),e("el-form-item",{attrs:{label:"标题"}},[e("div",{staticClass:"setTitle"},[e("el-input",{attrs:{placeholder:"最多60个字"},model:{value:o.foods.food.name,callback:function(t){o.$set(o.foods.food,"name",t)},expression:"foods.food.name"}})],1)]),o._v(" "),e("el-form-item",{attrs:{label:"描述"}},[e("div",{staticClass:"setTitle"},[e("el-input",{attrs:{type:"textarea",placeholder:"可以不写，最多300个字"},model:{value:o.foods.food.content,callback:function(t){o.$set(o.foods.food,"content",t)},expression:"foods.food.content"}})],1)]),o._v(" "),e("el-form-item",{attrs:{label:"规格"}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:0==o.showSku,expression:"showSku == false"}],on:{click:o.addSku}},[o._v("添加商品规格")]),o._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1==o.showSku,expression:"showSku == true"}],staticClass:"sku-group clearfix"},[e("table",{staticClass:"add-food-table",attrs:{cellspacing:"0"}},[e("thead",[e("tr",[e("th",{staticClass:"group-value"},[o._v("规格名称")]),o._v(" "),e("th",{staticClass:"group-price"},[o._v("价格(元)")]),o._v(" "),e("th",{staticClass:"food-stock"},[o._v("库存(份)")]),o._v(" "),e("th",{staticClass:"del-th"})])]),o._v(" "),e("tbody",o._l(o.foods.sku,function(t,s){return e("tr",{key:s},[e("td",{staticClass:"group-value"},[e("el-input",{attrs:{placeholder:"请填写规格名称"},model:{value:t.name,callback:function(e){o.$set(t,"name",e)},expression:"spec.name"}})],1),o._v(" "),e("td",{staticClass:"group-price"},[e("el-input",{model:{value:t.price,callback:function(e){o.$set(t,"price",e)},expression:"spec.price"}})],1),o._v(" "),e("td",{staticClass:"food-stock"},[e("div",{staticClass:"infi"},[e("el-radio-group",{model:{value:t.infinite_count,callback:function(e){o.$set(t,"infinite_count",e)},expression:"spec.infinite_count"}},[e("el-radio",{attrs:{label:1}},[o._v("无限库存")]),o._v(" "),e("el-radio",{attrs:{label:0}},[o._v("自定义库存")])],1)],1),o._v(" "),0==t.infinite_count?e("div",{staticClass:"infinput"},[e("el-input",{model:{value:t.store_count,callback:function(e){o.$set(t,"store_count",e)},expression:"spec.store_count"}})],1):o._e()]),o._v(" "),e("td",{staticClass:"del-th"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){o.delSku(t,s)}}},[o._v("删除")])],1)])}))]),o._v(" "),e("el-button",{on:{click:o.addSku}},[o._v("添加商品规格")])],1)],1),o._v(" "),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==o.showSku,expression:"showSku == false"}],attrs:{label:"价格"}},[e("el-col",{attrs:{span:3}},[e("el-input",{model:{value:o.foods.food.price,callback:function(t){o.$set(o.foods.food,"price",t)},expression:"foods.food.price"}})],1)],1),o._v(" "),e("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==o.showSku,expression:"showSku == false"}],attrs:{label:"库存"}},[e("div",{staticClass:"setStock"},[e("el-radio-group",{model:{value:o.foods.food.infinite_count,callback:function(t){o.$set(o.foods.food,"infinite_count",t)},expression:"foods.food.infinite_count"}},[e("el-radio",{attrs:{label:1}},[o._v("无限库存")]),o._v(" "),e("el-radio",{attrs:{label:0}},[o._v("自定义库存")])],1)],1),o._v(" "),0==o.foods.food.infinite_count?e("div",{staticClass:"setStore"},[e("el-input",{model:{value:o.foods.food.store_count,callback:function(t){o.$set(o.foods.food,"store_count",t)},expression:"foods.food.store_count"}})],1):o._e()]),o._v(" "),e("el-form-item",{attrs:{label:"属性"}},[e("el-button",{directives:[{name:"show",rawName:"v-show",value:0==o.showPro,expression:"showPro == false"}],on:{click:o.addPro}},[o._v("增加商品属性")]),o._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:1==o.showPro,expression:"showPro == true"}],staticClass:"sku-group clearfix"},[e("table",{staticClass:"add-value-table",attrs:{cellspacing:"0"}},[e("thead",[e("tr",[e("th",{staticClass:"name-value"},[o._v("属性名称")]),o._v(" "),e("th",{staticClass:"sub-value"},[o._v("属性细分(至少填写两个)")]),o._v(" "),e("th",{staticClass:"del-value"})])]),o._v(" "),e("tbody",o._l(o.foods.pro,function(t,s){return e("tr",{key:s},[e("td",{staticClass:"name-value"},[e("el-input",{attrs:{placeholder:"如:辣度"},model:{value:t.property.name,callback:function(e){o.$set(t.property,"name",e)},expression:"value.property.name"}})],1),o._v(" "),e("td",{staticClass:"sub-value"},o._l(t.property_child,function(t,s){return e("el-input",{key:s,model:{value:t.name,callback:function(e){o.$set(t,"name",e)},expression:"subdiv.name"}})})),o._v(" "),e("td",{staticClass:"del-value"},[e("el-button",{attrs:{type:"text"},on:{click:function(e){o.delPro(t.property,s)}}},[o._v("删除")])],1)])}))]),o._v(" "),e("el-button",{on:{click:o.addPro}},[o._v("增加商品属性")])],1)],1),o._v(" "),e("el-form-item",{attrs:{label:"分组"}},[e("el-button",{attrs:{icon:"el-icon-plus"},on:{click:function(t){o.showGroup=!0}}},[o._v("新建分组")]),o._v(" "),o._l(o.foodGroup,function(t,s){return e("el-radio",{key:s,attrs:{label:t.cat_id,border:""},model:{value:o.foods.food.cat_id,callback:function(t){o.$set(o.foods.food,"cat_id",t)},expression:"foods.food.cat_id"}},[o._v("\n\t    \t"+o._s(t.name)+"\n\t    ")])}),o._v(" "),e("p",{staticClass:"ui-color"},[o._v("商品需要放入分组后，才能展示给顾客")])],2),o._v(" "),e("el-form-item",{attrs:{label:""}},[e("el-button",{attrs:{type:"primary"},on:{click:o.subFood}},[o._v("保存")])],1)],1),o._v(" "),e("el-dialog",{attrs:{title:"新建分组",width:"40%",visible:o.showGroup},on:{"update:visible":function(t){o.showGroup=t}}},[e("el-input",{attrs:{placeholder:"分组名称,最多10个字"},nativeOn:{keyup:function(t){return"button"in t||!o._k(t.keyCode,"enter",13,t.key,"Enter")?o.addGroup(t):null}},model:{value:o.addGroupInfo.name,callback:function(t){o.$set(o.addGroupInfo,"name",t)},expression:"addGroupInfo.name"}}),o._v(" "),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){o.showGroup=!1}}},[o._v("取 消")]),o._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:o.addGroup}},[o._v("保存")])],1)],1)],1)},staticRenderFns:[]};var l=e("C7Lr")(i,n,!1,function(o){e("wWT3")},"data-v-4c0f602d",null);t.default=l.exports},wWT3:function(o,t){}});
//# sourceMappingURL=37.4fea6437ae26e3222355.js.map