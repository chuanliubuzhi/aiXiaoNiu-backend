webpackJsonp([35],{HGLK:function(e,t){},h2ft:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("kO88"),c=a("mC1u"),s={name:"addFood",components:{pushImage:o.a},data:function(){return{showGroup:!1,dialogVisible:!1,checkSpec:!0,checkValue:!0,foodGroup:[],createFood:{cat_id:1,the_image:[],name:"",describe:"",price:null,infinite_count:1,store_count:null,specs:[{name:"",price:null,infinite_count:1,store_count:null},{name:"",price:null,infinite_count:1,store_count:null}],values:[{property:{name:""},property_child:[{name:""},{name:""},{name:""},{name:""}]}],ctgName:null},addGroupInfo:{name:"",order_num:50}}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;Object(c.h)().then(function(t){e.foodGroup=t.data.data,e.createFood.ctgName=Number(e.$route.params.active)})},removeImage:function(e){this.createFood.the_image.splice(e,1)},addSpecTable:function(){this.createFood.specs.length>3?this.$message({message:"最多只能添加四种商品规格",type:"warning",center:!0}):this.createFood.specs.push({name:"",price:null,infinite_count:1,store_count:null})},delSpecTable:function(e){this.createFood.specs.splice(e,1),this.createFood.specs.length<1&&(this.checkSpec=!0,this.createFood.specs=[{name:"",price:null,infinite_count:1,store_count:null},{name:"",price:null,infinite_count:1,store_count:null}])},addValue:function(){this.createFood.values.push({property:{name:""},property_child:[{name:""},{name:""},{name:""},{name:""}]})},delValue:function(e){this.createFood.values.splice(e,1),this.createFood.values.length<1&&(this.checkValue=!0,this.createFood.values=[{property:{name:""},property_child:[{name:""},{name:""},{name:""},{name:""}]}])},addGroup:function(){var e=this;Object(c.a)(e.addGroupInfo).then(function(t){0==t.data.code?(e.showGroup=!1,e.fetchData(),e.$message({message:"创建成功！",type:"success"})):e.$message("创建失败")})},addFood:function(){var e=this,t=[];if(0!=e.createFood.the_image.length){for(var a=0;a<e.createFood.the_image.length;a++)t.push(e.createFood.the_image[a].img);if(1==e.checkSpec){var o={food:{cat_id:e.createFood.ctgName,name:e.createFood.name,price:e.createFood.price,infinite_count:e.createFood.infinite_count,store_count:e.createFood.store_count,content:e.createFood.describe,the_image:t},pro:e.createFood.values};Object(c.b)(o).then(function(t){0==t.data.code?(e.$message({type:"success",message:"发布成功!"}),e.$router.push("/food")):e.$message({type:"info",message:"发布失败!"})})}else if(0==e.checkSpec){var s={food:{cat_id:e.createFood.ctgName,name:e.createFood.name,price:0,infinite_count:e.createFood.infinite_count,store_count:e.createFood.store_count,content:e.createFood.describe,the_image:t},sku:e.createFood.specs,pro:e.createFood.values};Object(c.b)(s).then(function(t){0==t.data.code?(e.$message({type:"success",message:"发布成功!"}),e.$router.push("/food")):e.$message({type:"info",message:"发布失败!"})})}}else this.$message.error("需要选择图片")},showImage:function(e){this.createFood.the_image=e.splice(0,5)}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container",staticStyle:{background:"#fff"}},[a("el-form",{ref:"form",staticStyle:{"min-width":"800px"},attrs:{model:e.createFood,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"图片"}},[e._l(e.createFood.the_image,function(t,o){return a("div",{key:o,staticClass:"picture-list"},[a("div",{staticClass:"picture-list_pic",style:{background:"url("+t.img+")"}},[a("i",{staticClass:"el-icon-circle-close remove-list",on:{click:function(t){e.removeImage(o)}}})])])}),e._v(" "),a("push-image",{ref:"childImg",attrs:{imageList:e.createFood.the_image,imageNumber:"5"},on:{selected:e.showImage}}),e._v(" "),a("p",{staticClass:"ui-color"},[e._v("图片大小不超过3M，最多5张，建议使用方形图片")])],2),e._v(" "),a("el-form-item",{attrs:{label:"标题"}},[a("div",{staticClass:"setTitle"},[a("el-input",{attrs:{placeholder:"最多60个字"},model:{value:e.createFood.name,callback:function(t){e.$set(e.createFood,"name",t)},expression:"createFood.name"}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("div",{staticClass:"setTitle"},[a("el-input",{attrs:{type:"textarea",placeholder:"可以不写，最多300个字"},model:{value:e.createFood.describe,callback:function(t){e.$set(e.createFood,"describe",t)},expression:"createFood.describe"}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"规格"}},[e.checkSpec?a("el-button",{on:{click:function(t){e.checkSpec=!1}}},[e._v("添加商品规格")]):e._e(),e._v(" "),e.checkSpec?e._e():a("div",{staticClass:"sku-group clearfix"},[a("table",{staticClass:"add-food-table",attrs:{cellspacing:"0"}},[a("thead",[a("tr",[a("th",{staticClass:"group-value"},[e._v("规格名称")]),e._v(" "),a("th",{staticClass:"group-price"},[e._v("价格(元)")]),e._v(" "),a("th",{staticClass:"food-stock"},[e._v("库存(份)")]),e._v(" "),a("th",{staticClass:"del-th"})])]),e._v(" "),a("tbody",e._l(e.createFood.specs,function(t,o){return a("tr",{key:o},[a("td",{staticClass:"group-value"},[a("el-input",{attrs:{placeholder:"请填写规格名称"},model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"spec.name"}})],1),e._v(" "),a("td",{staticClass:"group-price"},[a("el-input",{model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"spec.price"}})],1),e._v(" "),a("td",{staticClass:"food-stock"},[a("div",{staticClass:"infi"},[a("el-radio-group",{model:{value:t.infinite_count,callback:function(a){e.$set(t,"infinite_count",a)},expression:"spec.infinite_count"}},[a("el-radio",{attrs:{label:1}},[e._v("无限库存")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("自定义库存")])],1)],1),e._v(" "),0==t.infinite_count?a("div",{staticClass:"infinput"},[a("el-input",{model:{value:t.store_count,callback:function(a){e.$set(t,"store_count",a)},expression:"spec.store_count"}})],1):e._e()]),e._v(" "),a("td",{staticClass:"del-th"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.delSpecTable(o)}}},[e._v("删除")])],1)])}))]),e._v(" "),a("el-button",{on:{click:e.addSpecTable}},[e._v("添加商品规格")])],1)],1),e._v(" "),e.checkSpec?a("el-form-item",{attrs:{label:"价格"}},[a("el-col",{attrs:{span:3}},[a("el-input",{model:{value:e.createFood.price,callback:function(t){e.$set(e.createFood,"price",t)},expression:"createFood.price"}})],1)],1):e._e(),e._v(" "),e.checkSpec?a("el-form-item",{attrs:{label:"库存"}},[a("div",{staticClass:"setStock"},[a("el-radio-group",{model:{value:e.createFood.infinite_count,callback:function(t){e.$set(e.createFood,"infinite_count",t)},expression:"createFood.infinite_count"}},[a("el-radio",{attrs:{label:1}},[e._v("无限库存")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("自定义库存")])],1)],1),e._v(" "),0==e.createFood.infinite_count?a("div",{staticClass:"setStore"},[a("el-input",{model:{value:e.createFood.store_count,callback:function(t){e.$set(e.createFood,"store_count",t)},expression:"createFood.store_count"}})],1):e._e()]):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"属性"}},[e.checkValue?a("el-button",{on:{click:function(t){e.checkValue=!1}}},[e._v("增加商品属性")]):e._e(),e._v(" "),e.checkValue?e._e():a("div",{staticClass:"sku-group clearfix"},[a("table",{staticClass:"add-value-table",attrs:{cellspacing:"0"}},[a("thead",[a("tr",[a("th",{staticClass:"name-value"},[e._v("属性名称")]),e._v(" "),a("th",{staticClass:"sub-value"},[e._v("属性细分(至少填写两个)")]),e._v(" "),a("th",{staticClass:"del-value"})])]),e._v(" "),a("tbody",e._l(e.createFood.values,function(t,o){return a("tr",{key:o},[a("td",{staticClass:"name-value"},[a("el-input",{attrs:{placeholder:"如:辣度"},model:{value:t.property.name,callback:function(a){e.$set(t.property,"name",a)},expression:"value.property.name"}})],1),e._v(" "),a("td",{staticClass:"sub-value"},e._l(t.property_child,function(t,o){return a("el-input",{key:o,model:{value:t.name,callback:function(a){e.$set(t,"name",a)},expression:"subdiv.name"}})})),e._v(" "),a("td",{staticClass:"del-value"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.delValue(o)}}},[e._v("删除")])],1)])}))]),e._v(" "),a("el-button",{on:{click:e.addValue}},[e._v("增加商品属性")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"分组"}},[a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:function(t){e.showGroup=!0}}},[e._v("新建分组")]),e._v(" "),e._l(e.foodGroup,function(t,o){return a("el-radio",{key:o,attrs:{label:t.cat_id,border:""},model:{value:e.createFood.ctgName,callback:function(t){e.$set(e.createFood,"ctgName",t)},expression:"createFood.ctgName"}},[e._v("\n\t    \t"+e._s(t.name)+"\n\t    ")])}),e._v(" "),a("p",{staticClass:"ui-color"},[e._v("商品需要放入分组后，才能展示给顾客")])],2),e._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-button",{attrs:{type:"primary"},on:{click:e.addFood}},[e._v("完成")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"新建分组",width:"40%",visible:e.showGroup},on:{"update:visible":function(t){e.showGroup=t}}},[a("el-input",{attrs:{placeholder:"分组名称,最多10个字"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.addGroup(t):null}},model:{value:e.addGroupInfo.name,callback:function(t){e.$set(e.addGroupInfo,"name",t)},expression:"addGroupInfo.name"}}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showGroup=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addGroup}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var i=a("C7Lr")(s,n,!1,function(e){a("HGLK")},"data-v-4dc41178",null);t.default=i.exports}});
//# sourceMappingURL=35.12a92818da55b9b9d2fe.js.map